<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="map[name:zyeinn]">
<meta name="description" content="In the summer of 2021, 2 friends and I were making the &amp;ldquo;schooled&amp;rdquo; Hackthebox machine, which uses the 3.9 version of moodle.
This version allowed RCE from a malicious plugin, you only needed to be an administrator for that. Looking further, we found an article from moodle talking about the existence of a Stored XSS by the parameter &amp;ldquo;moodle net profile&amp;rdquo; in the profile in version 3.9.1.
As that parameter was not sanitized, it allowed a malicious user to inject javascript code, making a simple paylaod to steal the cookie (MoodleSession) of the visitor who accessed his profile." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://zyeinn.github.io/posts/2022/01/the-day-i-found-a-vulnerability-in-my-universitys-moodle/" />


    <title>
        
            The day I found a vulnerability in my university&#39;s Moodle :: zyeinn&#39;s Blog 
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="https://zyeinn.github.io/main.17863a81d979b637a02cd7632a4d86e9d80563ef460fd6af1a56962efcaa066b.css">



    <link rel="apple-touch-icon" sizes="180x180" href="https://zyeinn.github.io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://zyeinn.github.io/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://zyeinn.github.io/favicon-16x16.png">
    <link rel="manifest" href="https://zyeinn.github.io/site.webmanifest">
    <link rel="mask-icon" href="https://zyeinn.github.io/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="https://zyeinn.github.io/favicon.ico">
    <meta name="msapplication-TileColor" content="">
    <meta name="theme-color" content="">



<meta itemprop="name" content="The day I found a vulnerability in my university&#39;s Moodle">
<meta itemprop="description" content="In the summer of 2021, 2 friends and I were making the &ldquo;schooled&rdquo; Hackthebox machine, which uses the 3.9 version of moodle.
This version allowed RCE from a malicious plugin, you only needed to be an administrator for that. Looking further, we found an article from moodle talking about the existence of a Stored XSS by the parameter &ldquo;moodle net profile&rdquo; in the profile in version 3.9.1.
As that parameter was not sanitized, it allowed a malicious user to inject javascript code, making a simple paylaod to steal the cookie (MoodleSession) of the visitor who accessed his profile."><meta itemprop="datePublished" content="2022-01-04T00:00:00+00:00" />
<meta itemprop="dateModified" content="2022-01-04T00:00:00+00:00" />
<meta itemprop="wordCount" content="184"><meta itemprop="image" content="https://zyeinn.github.io/"/>
<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://zyeinn.github.io/"/>

<meta name="twitter:title" content="The day I found a vulnerability in my university&#39;s Moodle"/>
<meta name="twitter:description" content="In the summer of 2021, 2 friends and I were making the &ldquo;schooled&rdquo; Hackthebox machine, which uses the 3.9 version of moodle.
This version allowed RCE from a malicious plugin, you only needed to be an administrator for that. Looking further, we found an article from moodle talking about the existence of a Stored XSS by the parameter &ldquo;moodle net profile&rdquo; in the profile in version 3.9.1.
As that parameter was not sanitized, it allowed a malicious user to inject javascript code, making a simple paylaod to steal the cookie (MoodleSession) of the visitor who accessed his profile."/>




    <meta property="og:title" content="The day I found a vulnerability in my university&#39;s Moodle" />
<meta property="og:description" content="In the summer of 2021, 2 friends and I were making the &ldquo;schooled&rdquo; Hackthebox machine, which uses the 3.9 version of moodle.
This version allowed RCE from a malicious plugin, you only needed to be an administrator for that. Looking further, we found an article from moodle talking about the existence of a Stored XSS by the parameter &ldquo;moodle net profile&rdquo; in the profile in version 3.9.1.
As that parameter was not sanitized, it allowed a malicious user to inject javascript code, making a simple paylaod to steal the cookie (MoodleSession) of the visitor who accessed his profile." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zyeinn.github.io/posts/2022/01/the-day-i-found-a-vulnerability-in-my-universitys-moodle/" /><meta property="og:image" content="https://zyeinn.github.io/"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-01-04T00:00:00+00:00" />
<meta property="article:modified_time" content="2022-01-04T00:00:00+00:00" />







    <meta property="article:published_time" content="2022-01-04 00:00:00 &#43;0000 UTC" />










    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://zyeinn.github.io/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">&gt;</span>
            <span class="logo__text">$ cd /home/</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://zyeinn.github.io/about/">About</a></li><li><a href="https://zyeinn.github.io/posts/">Posts</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
        </span>
    </span>
</header>


            <div class="content">
                
  <main class="post">

    <div class="post-info">
      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
        One minute

        
      </p>
    </div>

    <article>
      <h1 class="post-title">
        <a href="https://zyeinn.github.io/posts/2022/01/the-day-i-found-a-vulnerability-in-my-universitys-moodle/">The day I found a vulnerability in my university&rsquo;s Moodle</a>
      </h1>

      

      

      

      <div class="post-content">
        <p>In the summer of 2021, 2 friends and I were making the &ldquo;schooled&rdquo; Hackthebox machine, which uses the 3.9 version of moodle.</p>
<p>This version allowed RCE from a malicious plugin, you only needed to be an administrator for that. Looking further, we found an article from moodle talking about the existence of a Stored XSS by the parameter &ldquo;moodle net profile&rdquo; in the profile in version 3.9.1.</p>
<p>As that parameter was not sanitized, it allowed a malicious user to inject javascript code, making a simple paylaod to steal the cookie (MoodleSession) of the visitor who accessed his profile. With the stolen cookie, the malicious user can change his cookie to the victim, having full access to the account.</p>
<p>After rooting the machine, I went to see the version of Moodle from my university and I came across 3.9.1, the same one that allowed Stored XSS.</p>
<p>So I went to test if it was possible and it was.</p>
<p>I sent an email straight away to the responsible of the infrastructure and within a few weeks they had already solved the problem.</p>
<h3 id="proof-of-concept-">Proof of Concept :</h3>
<p><a href="https://zyeinn.github.io/img/poc.mp4" title="Video"><img src="https://zyeinn.github.io/img/poc.png" alt="POC"></a></p>

      </div>
    </article>

    <hr />

    <div class="post-info">
      
      

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        184 Words
      </p>

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="16" y1="2" x2="16" y2="6"></line>
          <line x1="8" y1="2" x2="8" y2="6"></line>
          <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
        
          2022-01-04 00:00
        

         
          
        
      </p>
    </div>

    

    

    

  </main>

            </div>

            
                <footer class="footer">
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2022</span>
            <span><a href="https://zyeinn.github.io/">zyeinn</a></span>
            <span><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></span>
            
            
        </div>
    </div>
    
    
</footer>

            
        </div>

        



<script type="text/javascript" src="https://zyeinn.github.io/bundle.min.599099f1f14b78b657d524b28e10e0c5098e7cd46e9c7aed73d577068a276c3ff1bb234cbf29cb313333e83cf411727b43157c91ce5b809e2ffc81664614608e.js" integrity="sha512-WZCZ8fFLeLZX1SSyjhDgxQmOfNRunHrtc9V3BoonbD/xuyNMvynLMTMz6Dz0EXJ7QxV8kc5bgJ4v/IFmRhRgjg=="></script>



    </body>
</html>
