<!DOCTYPE html>
<html lang="en" class="html" data-theme="dark"><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>
    
      The Day I Found A Vulnerability In My University’s Moodle ~ Story Time
    
  </title>

  <!-- Begin Jekyll SEO tag v2.7.3 -->
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="The Day I Found A Vulnerability In My University’s Moodle ~ Story Time" />
<meta name="author" content="zyeinn" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In the summer of 2021, my two friends and I embarked on a journey to solve the “schooled” Hackthebox machine. Our enthusiasm for cybersecurity led us to explore the various features of Moodle, and during our exploration, we uncovered a critical vulnerability." />
<meta property="og:description" content="In the summer of 2021, my two friends and I embarked on a journey to solve the “schooled” Hackthebox machine. Our enthusiasm for cybersecurity led us to explore the various features of Moodle, and during our exploration, we uncovered a critical vulnerability." />
<link rel="canonical" href="https://zyeinn.github.io//the-day-i-found-a-vulnerability-in-my-university-s-moodle-story-time" />
<meta property="og:url" content="https://zyeinn.github.io//the-day-i-found-a-vulnerability-in-my-university-s-moodle-story-time" />
<meta property="og:site_name" content="zyeinn’s blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-12-18T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="The Day I Found A Vulnerability In My University’s Moodle ~ Story Time" />
<script type="application/ld+json">
{"headline":"The Day I Found A Vulnerability In My University’s Moodle ~ Story Time","dateModified":"2021-12-18T00:00:00+00:00","datePublished":"2021-12-18T00:00:00+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://zyeinn.github.io//the-day-i-found-a-vulnerability-in-my-university-s-moodle-story-time"},"author":{"@type":"Person","name":"zyeinn"},"@type":"BlogPosting","description":"In the summer of 2021, my two friends and I embarked on a journey to solve the “schooled” Hackthebox machine. Our enthusiasm for cybersecurity led us to explore the various features of Moodle, and during our exploration, we uncovered a critical vulnerability.","url":"https://zyeinn.github.io//the-day-i-found-a-vulnerability-in-my-university-s-moodle-story-time","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  <link type="application/atom+xml" rel="alternate" href="https://zyeinn.github.io//feed.xml" title="zyeinn&apos;s blog" />

  <!-- Favicon -->
  <meta name="msapplication-TileColor" content="#00aba9">
  <meta name="theme-color" content="#ffffff">
  <!-- Favicon -->

  <link rel="stylesheet" href="/assets/css/main.css" />
  
    <script type="text/javascript">
  window.addEventListener('load', themeChange);
  const currentTheme = localStorage.getItem('theme') ? localStorage.getItem('theme') : null;
  if (currentTheme)
    document.documentElement.setAttribute('data-theme', currentTheme);

  function themeChange() {
    let button = document.querySelector('.theme-toggle');

    button.addEventListener('click', function (e) {
      let currentTheme = document.documentElement.getAttribute('data-theme');
      if (currentTheme === 'dark') {
        transition();
        document.documentElement.setAttribute('data-theme', 'light');
        localStorage.setItem('theme', 'light');
      } else {
        transition();
        document.documentElement.setAttribute('data-theme', 'dark');
        localStorage.setItem('theme', 'dark');
      }
    });

    let transition = () => {
      document.documentElement.classList.add('transition');
      window.setTimeout(() => {
        document.documentElement.classList.remove('transition');
      }, 1000);
    }
  }
</script>


  
</head>
<body>
    <main class="page-content" aria-label="Content">
      <div class="w">
        <a href="/">/back</a>
<h1 class="post-title">The Day I Found A Vulnerability In My University’s Moodle ~ Story Time</h1>
<p class="post-date text-bold">
  
    <span class="text-upcase">zyeinn</span> / 
  
  
    <span class="text-upcase">December 2021</span>
  


</p>

<div class="soopr-btn"
   data-twitter="SooprCo"
>
</div>



<p>In the summer of 2021, my two friends and I embarked on a journey to solve the “schooled” Hackthebox machine. Our enthusiasm for cybersecurity led us to explore the various features of Moodle, and during our exploration, we uncovered a critical vulnerability.</p>

<p>The vulnerability allowed Remote Code Execution (RCE) through a malicious plugin, which could be exploited by any administrator. Further investigation led us to discover an article from Moodle, revealing a Stored XSS vulnerability in version 3.9.1. The “moodle net profile” parameter was not properly sanitized, allowing a malicious user to inject JavaScript code and create a simple payload to steal the victim’s MoodleSession cookie. With the stolen cookie, the attacker could access the victim’s account with full privileges.</p>

<p>As we rooted the machine, I remembered that my university was also using Moodle version 3.9.1. I quickly tested the same vulnerability on my university’s Moodle instance and found that it was indeed vulnerable. I knew that this posed a significant risk to the university’s users, so I immediately reported the vulnerability to the responsible party.</p>

<p>The responsible party was prompt in their response and acknowledged the issue. I provided them with the details of the vulnerability and a proof-of-concept exploit. Within a few weeks, the vulnerability was patched, and the issue was resolved.</p>

<p>This experience taught us the importance of responsible disclosure and the need to continuously search for vulnerabilities in any system, no matter how secure it may seem. It also showed us the potential risks of using older versions of software that may have known vulnerabilities.</p>

<h3 id="proof-of-concept">Proof of Concept</h3>

<p><a href="./images/poc.mp4"><img src="./images/poc.png" alt="POC" /></a></p>


        
          <button title="Toggle Theme" class="theme-toggle">
  <svg viewBox="0 0 32 32" width="24" height="24" fill="currentcolor">
    <circle cx="16" cy="16" r="14" fill="none" stroke="currentcolor" stroke-width="4"></circle>
    <path d="
             M 16 0
             A 16 16 0 0 0 16 32
             z">
    </path>
  </svg>
</button>

        
        <div class="credits">&copy;&nbsp;2023&nbsp;zyeinn
          &nbsp;
          •
          &nbsp;Theme&nbsp; <a href="https://github.com/abhinavs/moonwalk" target="_blank" rel="noreferrer">Moonwalk</a>
        </div>
      </div>
    </main></body>
</html>
